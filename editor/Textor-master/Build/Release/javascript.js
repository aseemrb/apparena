var Textor;
(function(d){var b=function(){this._regExpCommands={g:!0,i:!0,m:!0};this._blockStatements={"if":!0,"while":!0,"with":!0,"for":!0,"else":!0,"do":!0,"try":!0,"catch":!0,"finally":!0,"switch":!0,"case":!0,"default":!0};this._expressionStatements={"return":!0,"delete":!0,"throw":!0};this._terminalStatements={"break":!0,"continue":!0};this._literals={"true":!0,"false":!0,"null":!0,undefinded:!0,NaN:!0,Infinity:!0};this._operators={"in":!0,"typeof":!0,"instanceof":!0,"new":!0};this._locals={"this":!0,arguments:!0}};
b.prototype.begin=function(a){this._textReader=a;this._tokenStack=[{type:this.readBlockStatement,state:"root"}];this._token=null};b.prototype.read=function(){this._state=null;this._token=this._tokenStack[this._tokenStack.length-1];var a=this._token.type.apply(this);0===this._textReader.peek().length&&(this.popToken(this.readExpression),this.popToken(this.readVariable),this.popToken(this.readStatement));return{style:a,state:this._state}};b.prototype.readLineComment=function(){this.terminate("\n");
return"comment"};b.prototype.readBlockComment=function(){this.terminate("*/");return"comment"};b.prototype.readStatement=function(){if("}"===this._textReader.peek())return this.pop(),null;if(this._textReader.match(";")||this._textReader.match(","))return this.pop(),"punctuation";if(this._textReader.match("{"))return this.push({type:this.readBlockStatement,state:""}),"punctuation";if(this._textReader.skipLineTerminators())return"text";this._token.start&&2>=this._tokenStack.length&&(this._state="base",
this._token.start=!1);var a=this.readExpression();0===this._textReader.peek().length&&this.pop();return a};b.prototype.readExpression=function(){var a=this._textReader.peek();if(")"===a||"}"===a||"]"===a||","===a||";"===a)return this.pop(),null;if(this._textReader.skipLineTerminators()||this._textReader.skipWhitespaces())return"text";if(this.matchComment())return"comment";if(this.matchLiteral()||this.matchRegExp())return this._token.continuation=!1,this._token.regexp=!1,"literal";if(this.matchBlockExpression())return this._token.continuation=
!1,this._token.regexp=!1,"punctuation";if(this._textReader.match("++")||this._textReader.match("--"))return this._token.regexp=!1,"punctuation";if(/[+\-*^&%<>!|]/.test(a))return this._token.continuation=!0,this._token.regexp=!0,this._textReader.read(),"punctuation";if("?"===a||"="===a)return this._textReader.read(),this._token.regexp=!0,this._token.continuation=!0,this.push({type:this.readExpression,continuation:!0,regexp:!0}),"punctuation";if(":"===a)return this._textReader.read(),this._token.regexp=
!0,this._token.continuation=!0,"punctuation";if("."===a||"/"===a)return this._textReader.read(),this._token.continuation=!0,"punctuation";if(!this._token.continuation)return this.pop(),null;a=this.readWord();if("function"===a)return this._token.continuation=!1,this.push({type:this.readFunction,name:"",state:"name"}),"keyword";if("var"===a||"const"===a)return this.push({type:this.readVariable,state:"none"}),"keyword";if(this._token.type===this.readStatement){if(this._blockStatements.hasOwnProperty(a)||
this._terminalStatements.hasOwnProperty(a))return"keyword";if(this._expressionStatements.hasOwnProperty(a))return this.push({type:this.readExpression,continuation:!0,regexp:!0}),"keyword"}if(this._locals.hasOwnProperty(a)||this._operators.hasOwnProperty(a))return this._token.regexp=!1,"keyword";if(this._literals.hasOwnProperty(a))return"literal";if(0<a.length)return this._token.continuation=!1,this._token.regexp=!1,"text";this._textReader.read();return"error"};b.prototype.readBlockStatement=function(){if(this._textReader.match("}"))return this._token.type===
this.readBlockStatement&&"root"!==this._token.state?(this.pop(),"punctuation"):"error";if(this.matchComment())return"comment";if(this._textReader.match("]")||this._textReader.match(")"))return"error";this.push({type:this.readStatement,continuation:!0,regexp:!0,start:!0});return null};b.prototype.readBlockExpression=function(){if(this._textReader.match(",")||this._textReader.match(";"))return"punctuation";if(this.matchComment())return"comment";this.push({type:this.readExpression,continuation:!0,regexp:!0});
return null};b.prototype.readArray=function(){return this._textReader.match("]")?(this.pop(),"punctuation"):this._textReader.match("}")||this._textReader.match(")")?"error":this.readBlockExpression()};b.prototype.readArguments=function(){return this._textReader.match(")")?(this.pop(),"punctuation"):this._textReader.match("]")||this._textReader.match("}")?"error":this.readBlockExpression()};b.prototype.readObject=function(){if(this._textReader.match("}"))return this.pop(),"punctuation";if(this._textReader.match("]")||
this._textReader.match(")"))return"error";if(this._textReader.skipWhitespaces()||this._textReader.skipLineTerminators())return"text";if(this._textReader.match(","))return this._token.identifier=!0,"punctuation";if(this._token.identifier){this._textReader.save();if(0<this.readWord().length&&(this._textReader.skipWhitespaces(),":"===this._textReader.peek()))return this._textReader.restore(),this.readWord(),"declaration";this._textReader.restore()}this._token.identifier=!1;return this.readBlockExpression()};
b.prototype.readFunction=function(){if("block"==this._token.state)return this.pop(),null;if(this._textReader.skipWhitespaces()||this._textReader.skipLineTerminators())return"text";if("name"==this._token.state){var a=this._textReader.peek();if(/[\w\$_]/.test(a))return this._token.name+=this._textReader.read(),"declaration";this._token.state="next";return null}if(this._textReader.match("("))return this._token.state="parameters",this.push({type:this.readParameters}),"punctuation";if(this.matchComment())return"comment";
if(this._textReader.match("{"))return this._token.state="block",this.push({type:this.readBlockStatement,delimiter:"}"}),"punctuation";this._textReader.read();return"error"};b.prototype.readParameters=function(){if(this._textReader.match(")"))return this.pop(),"punctuation";if(this._textReader.match(","))return"punctuation";if(this._textReader.skipWhitespaces()||this._textReader.skipLineTerminators())return"text";if(this.matchComment())return"comment";if(0<this.readWord().length)return"declaration";
this._textReader.read();return"error"};b.prototype.readString=function(){this._textReader.match("\\")?this._token.value+="\\"+this._textReader.read():this._textReader.match(this._token.value[0])?(this._token.value+=this._token.value[0],this.pop()):this._token.value+=this._textReader.read();return"literal"};b.prototype.readNumber=function(){var a=this._textReader.peek();if("0"<=a&&"9">=a)return this._token.value+=this._textReader.read(),"literal";if("."==a&&this._token.comma&&"00"!==this._token.value)return this._token.comma=
!1,this._token.value+=this._textReader.read(),"literal";if("E"===a||"e"===a){this._token.comma=!1;this._token.value+=this._textReader.read();a=this._textReader.peek();if("+"===a||"-"===a)this._token.value+=this._textReader.read();return"literal"}this.pop();return null};b.prototype.readHexNumber=function(){var a=this._textReader.peek();if("0"<=a&&"9">=a||"a"<=a&&"f">=a||"A"<=a&&"F">=a)return this._token.value+=this._textReader.read(),"literal";this.pop();return null};b.prototype.readVariable=function(){if(";"===
this._textReader.peek())return this.pop(),null;if(this.matchComment())return"comment";if("none"===this._token.state){if(this._textReader.skipLineTerminators()||this._textReader.skipWhitespaces())return"text";this._token.state="name";this._token.name=this._textReader.read();return"declaration"}if("name"===this._token.state){if(this._textReader.skipLineTerminators()||this._textReader.skipWhitespaces())return this._token.state="next","text";if(","===this._textReader.peek()||"="===this._textReader.peek())return this._token.state=
"next",null;this._token.name+=this._textReader.read();return"declaration"}if("next"===this._token.state){if(this._textReader.skipLineTerminators()||this._textReader.skipWhitespaces())return"text";if(this._textReader.match(","))return this.pop(),this.push({type:this.readVariable,state:"none",name:""}),"punctuation";if(this._textReader.match("="))return this._token.state="expression",this.push({type:this.readExpression,continuation:!0,regexp:!0}),"punctuation";if(this._textReader.match("in"))return this.pop(),
"keyword"}else if("expression"===this._token.state){if(this._textReader.skipLineTerminators())return null;if(this._textReader.skipWhitespaces())return"text";if(","===this._textReader.peek())return this._token.state="next",null}this.pop();return null};b.prototype.matchLiteral=function(){this._textReader.save();var a=this._textReader.read(),b=a;if("'"===a||'"'===a)return this.push({type:this.readString,value:b}),!0;var c=!0;"-"===a&&(a=this._textReader.read(),b+=a);if("0"===a&&"X"===this._textReader.peek().toUpperCase())return b+=
this._textReader.read(),this.push({type:this.readHexNumber,value:b,comma:!1}),!0;"."===a&&(a=this._textReader.read(),b+=a,c=!1);if("0"<=a&&"9">=a)return this.push({type:this.readNumber,value:b,comma:c}),!0;this._textReader.restore();return!1};b.prototype.matchRegExp=function(){this._textReader.save();if(this._token.regexp&&this._textReader.match("/"))for(;0<this._textReader.peek().length&&!this._textReader.skipLineTerminators();)if(this._textReader.match("\\"))this._textReader.read();else if(this._textReader.match("[")){for(var a=
!1;0<this._textReader.peek().length&&!this._textReader.skipLineTerminators();){if(this._textReader.match("]")){a=!0;break}this._textReader.match("\\");this._textReader.read()}if(!a)break}else{if(this._textReader.match("/")){for(;0<this._textReader.peek().length&&this._regExpCommands.hasOwnProperty(this._textReader.peek());)this._textReader.read();return!0}this._textReader.read()}this._textReader.restore();return!1};b.prototype.matchBlockExpression=function(){return this._textReader.match("{")?(this.push({type:this.readObject,
identifier:!0}),!0):this._textReader.match("(")?(this.push({type:this.readArguments}),!0):this._textReader.match("[")?(this.push({type:this.readArray}),!0):!1};b.prototype.matchComment=function(){return this._textReader.match("//")?(this.push({type:this.readLineComment}),!0):this._textReader.match("/*")?(this.push({type:this.readBlockComment}),!0):!1};b.prototype.readWord=function(){for(var a="",b;0<(b=this._textReader.peek()).length&&/[\w\$_]/.test(b);)a+=b,this._textReader.read();return a};b.prototype.terminate=
function(a){if(this._textReader.match(a))return this.pop(),!0;this._textReader.read();return!1};b.prototype.popToken=function(a){1<this._tokenStack.length&&this._tokenStack[this._tokenStack.length-1].type===a&&this.pop()};b.prototype.push=function(a){this._tokenStack.push(a)};b.prototype.pop=function(){this._tokenStack.pop()};d.JavaScriptLanguage=b})(Textor||(Textor={}));
